{"ast":null,"code":"import'bootstrap/dist/css/bootstrap.css';import React,{useState,useEffect}from'react';import Masonry from'masonry-layout';import axiosInstance from'./AxiosConf/axiosconf';//Componentes\nimport CardContainer from'./components/cardContainerDashboard';import Menu from'./components/menuComponent';import{usePerfil}from'./components/publicacionUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const[allImg,setAllImg]=useState([]);const[base64Images,setBase64Images]=useState([]);const[hasFollowed,setHasFollowed]=useState(true);const perfil=usePerfil();useEffect(()=>{axiosInstance.get(\"http://localhost:3001/getufollowed\").then(response=>{if(response.data===\"No imagen\"){alert(\"No hay imágenes\");}else{setAllImg(response.data);}}).catch(error=>{console.error(\"Error fetching images:\",error);});},[]);useEffect(()=>{if(allImg.length>0&&Array.isArray(allImg[0])&&allImg[0].length===0){console.log(\"No hay datos en allImg[0]\");setHasFollowed(false);}},[allImg]);useEffect(()=>{const convertImagesToBase64=async()=>{if(allImg.length>0&&Array.isArray(allImg[0])&&allImg[0].length>0){const base64Promises=allImg[0].map(val=>{const blob=new Blob([new Uint8Array(val.foto_post.data)],{type:'image/jpeg'});const reader=new FileReader();reader.readAsDataURL(blob);return new Promise(resolve=>{reader.onloadend=()=>{resolve(reader.result.split(',')[1]);};});});try{const base64Strings=await Promise.all(base64Promises);setBase64Images(base64Strings);}catch(error){console.error(\"Error converting images to base64:\",error);}}};convertImagesToBase64();},[allImg]);useEffect(()=>{const initializeMasonry=()=>{const grid=document.querySelector('.row-cols-md-3');if(grid){const masonry=new Masonry(grid,{itemSelector:'.col',percentPosition:true});masonry.layout();}};initializeMasonry();},[allImg]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Menu,{perfil:perfil}),hasFollowed?/*#__PURE__*/_jsx(CardContainer,{data:base64Images.map((base64String,index)=>({imageUrl:base64String,title:allImg[0][index].titulo_post,idPost:allImg[0][index].id_post}))}):/*#__PURE__*/_jsx(\"div\",{className:\"container d-flex justify-content-center align-items-center\",style:{minHeight:'100vh'},children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",style:{fontSize:'2rem'},children:\"Comienza a seguir tus artistas favoritos en \\\"Explorar\\\"\"})})]});}export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","Masonry","axiosInstance","CardContainer","Menu","usePerfil","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Dashboard","allImg","setAllImg","base64Images","setBase64Images","hasFollowed","setHasFollowed","perfil","get","then","response","data","alert","catch","error","console","length","Array","isArray","log","convertImagesToBase64","base64Promises","map","val","blob","Blob","Uint8Array","foto_post","type","reader","FileReader","readAsDataURL","Promise","resolve","onloadend","result","split","base64Strings","all","initializeMasonry","grid","document","querySelector","masonry","itemSelector","percentPosition","layout","children","base64String","index","imageUrl","title","titulo_post","idPost","id_post","className","style","minHeight","fontSize"],"sources":["D:/Clases/Programacion Web II/PW2_Project/pw2/front/src/Dashboard.js"],"sourcesContent":["import 'bootstrap/dist/css/bootstrap.css';\nimport React, { useState, useEffect } from 'react';\nimport Masonry from 'masonry-layout';\nimport axiosInstance from './AxiosConf/axiosconf';\n\n//Componentes\nimport CardContainer from './components/cardContainerDashboard';\nimport Menu from './components/menuComponent';\nimport {usePerfil} from './components/publicacionUtils';\n\nfunction Dashboard() {\n    const [allImg, setAllImg] = useState([]);\n    const [base64Images, setBase64Images] = useState([]);\n    const [hasFollowed, setHasFollowed] = useState(true);\n    const perfil = usePerfil();    \n\n    useEffect(() => {\n        axiosInstance.get(\"http://localhost:3001/getufollowed\")\n            .then((response) => {\n                if (response.data === \"No imagen\") {\n                    alert(\"No hay imágenes\");\n                } else {\n                    setAllImg(response.data);\n                }\n            })\n            .catch((error) => {\n                console.error(\"Error fetching images:\", error);\n            });\n    }, []);\n\n    useEffect(() => {\n        if (allImg.length > 0 && Array.isArray(allImg[0]) && allImg[0].length === 0) {\n            console.log(\"No hay datos en allImg[0]\");\n            setHasFollowed(false);\n        }\n    }, [allImg]);\n\n    useEffect(() => {\n        const convertImagesToBase64 = async () => {\n            if (allImg.length > 0 && Array.isArray(allImg[0]) && allImg[0].length > 0) {\n                const base64Promises = allImg[0].map((val) => {\n                    const blob = new Blob([new Uint8Array(val.foto_post.data)], { type: 'image/jpeg' });\n                    const reader = new FileReader();\n                    reader.readAsDataURL(blob);\n                    return new Promise((resolve) => {\n                        reader.onloadend = () => {\n                            resolve(reader.result.split(',')[1]);\n                        };\n                    });\n                });\n\n                try {\n                    const base64Strings = await Promise.all(base64Promises);\n                    setBase64Images(base64Strings);\n                } catch (error) {\n                    console.error(\"Error converting images to base64:\", error);\n                }\n            }\n        };\n\n        convertImagesToBase64();\n    }, [allImg]);\n\n    useEffect(() => {\n        const initializeMasonry = () => {\n            const grid = document.querySelector('.row-cols-md-3');\n            if (grid) {\n                const masonry = new Masonry(grid, {\n                    itemSelector: '.col',\n                    percentPosition: true\n                });\n                masonry.layout();\n            }\n        };\n\n        initializeMasonry();\n    }, [allImg]);\n\n    return (\n        <>\n            <Menu perfil={perfil} /> \n            {hasFollowed ?\n                (\n                    <CardContainer data={\n                        base64Images.map(\n                            (base64String, index) => (\n                                {\n                                    imageUrl: base64String,\n                                    title: allImg[0][index].titulo_post,\n                                    idPost: allImg[0][index].id_post\n                                }\n                            )\n                        )\n                    } />\n                )\n                :\n                (\n                    <div className=\"container d-flex justify-content-center align-items-center\" style={{ minHeight: '100vh' }}>\n                        <div className=\"text-center\" style={{ fontSize: '2rem' }}>\n                            Comienza a seguir tus artistas favoritos en \"Explorar\"\n                        </div>\n                    </div>\n                )\n            }\n        </>\n    );\n}\n\nexport default Dashboard;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}